# 要件定義書: カフェ・レストラン可視化アプリ

## 1. 背景と目的
- おしゃれなカフェやレストランを探すエンドユーザーが、雰囲気や利用シーンに合う店舗を直感的に見つけられる情報提供を目指す。
- InstagramなどSNSや口コミサイトに散在する情報をAIで分析・要約し、信頼できる形でマップ上に表示することで、情報収集の手間と時間を削減する。
- 本サービスは開発者本人と家族・友人など最大6名程度の限定利用を想定し、アクセス制御によって一般公開を行わない。

## 2. ステークホルダー
- **エンドユーザー**: 週末外食、旅行、リモートワークなどで店舗選びを行う一般ユーザー。
- **サービス運用チーム**: データ収集基盤・AIモデルの運用管理、コンテンツ品質管理、問い合わせ対応を担う内部チーム。

## 3. スコープ
- **対象エリア**: 初期リリースは主要都市（例: 東京23区）を中心とし、利用状況に応じて順次拡大。
- **店舗カテゴリ**: カフェ、レストラン、バーなど「雰囲気」を評価しやすい飲食店。
- **対象プラットフォーム**: Webブラウザ（レスポンシブ対応）。ネイティブアプリは将来検討。
- **データソース**: 公開SNS・口コミサイトの公開情報を対象とし、利用規約に従って収集・分析。

## 4. ペルソナとニーズ
- **ペルソナA: 20代女性・会社員**
  - ニーズ: 友人との週末ランチで写真映えするスポットを見つけたい。混雑状況や人気度も重視。
- **ペルソナB: 30代男性・フリーランス**
  - ニーズ: 平日に作業できるカフェを探す。Wi-Fi、電源、静かな雰囲気の有無を知りたい。
- **ペルソナC: 40代男女・観光客**
  - ニーズ: 旅先で地元の人気店を効率的に探したい。SNSや口コミの評価を簡潔に把握したい。

## 5. ユースケース
1. アプリ利用時に招待コードまたは許可済みアカウントでログインし、限定メンバーのみがアクセスする。
2. AIが抽出した雰囲気タグ・人気度を基に、マップ上で店舗を検索・可視化する。
3. 現在地や指定エリア周辺で、SNSで話題の店舗をワンタップで表示する。
4. 店舗詳細ページで、AI要約された口コミポイント・代表写真・混雑傾向を確認する。
5. 条件（価格帯、席タイプ、設備、雰囲気タグ）で絞り込みを行う。
6. 気になる店舗をお気に入り保存し、個人のリストを作成する。

## 6. 機能要件
- **MVP**
  - SNS・口コミ情報の自動収集とAIによる雰囲気タグ抽出、人気度スコアリング。
  - 店舗データの地図表示、キーワード検索、カテゴリフィルタ。
  - 現在地または指定エリア周辺のおすすめ店舗サジェスト。
  - 店舗詳細表示（基本情報、AI要約、代表写真リンク、混雑傾向、主要設備）。
  - お気に入り登録・簡易メモ機能（ローカルストレージ管理想定）。
  - 招待制アクセス制御（共通パスコード、ワンタイムコード、または許可済みアカウントのいずれかで認証）と簡易ユーザー管理。
- **将来拡張 (優先度順)**
  1. パーソナライズされたレコメンド（閲覧・お気に入り履歴を用いたAI推薦）。
  2. 人気トレンドのタイムライン表示や通知機能。
  3. 多言語対応（AI翻訳を含む）。
  4. ルート案内サービスとの連携。

## 7. 非機能要件
- **パフォーマンス**: マップ初期表示3秒以内、検索結果反映2秒以内、AI要約表示は事前生成で遅延を抑制。
- **可用性**: 稼働率99%以上、データ収集バッチの失敗時は自動リトライと通知。
- **セキュリティ**: APIキー・認証情報の安全管理、HTTPS必須、SNS連携時はOAuthフローを遵守。アクセス制御により許可済みユーザー以外の利用を遮断。
- **拡張性**: 新たなSNSやデータソースを追加しやすいモジュール化されたアーキテクチャ。
- **アクセシビリティ**: 色覚多様性に配慮した配色、スクリーンリーダ対応、キーボード操作対応。

## 8. データ要件
- **店舗データ項目**: 店名、カテゴリ、住所、緯度・経度、営業時間、価格帯、設備（Wi-Fi、電源等）、席数、代表写真URL。
- **AI生成データ項目**: 雰囲気タグ（例: 「落ち着いた」「写真映え」など）、人気度スコア、混雑傾向、レビュー要約テキスト、トレンド指標。
- **データ取得フロー**: SNS公式APIまたは許可されたスクレイピング手法で公開データを収集し、ETL → AI分析 → データベース格納までを自動化。
- **コンプライアンス**: 各SNSの利用規約とAPIポリシーを遵守。個人情報や非公開情報は扱わない。
- **更新頻度**: SNS投稿は日次～数時間単位で更新、AI要約は収集ごとに再生成、マップ表示用データはキャッシュ層で高速提供。

## 9. 技術スタック想定
- **フロントエンド**: TypeScript + React or Next.js、Google Maps JavaScript APIを用いた地図描画、UIコンポーネントライブラリ（MUIなど）。
- **バックエンド/API**: Node.js（Express/Fastify）またはAzure Functionsをベースとしたサーバーレス構成。
- **データ処理**: Azure Data FactoryやAzure FunctionsでETLを実行し、AI推論はAzure Machine LearningもしくはAzure OpenAI ServiceとPython (PyTorch/Transformers) を組み合わせて実装。
- **データベース**: 店舗メタデータはAzure Cosmos DBまたはAzure Database for PostgreSQL + PostGIS、テキスト・ベクトル検索はAzure Cognitive Searchを活用。
- **インフラ**: Azure上でのリソース管理（App Service / Static Web Apps / Functions）、Azure Monitorによる監視、Azure DevOpsまたはGitHub ActionsでCI/CD構築。

## 10. 外部連携・API
- SNSデータ: Instagram Graph API、TikTok、Twitter(X)などの公開API。利用制限・承認手続きに合わせた実装が必要。
- 口コミサイト: Yelp、Google Placesなどの公式API。
- 地図表示: Google Maps Platform（JavaScript API / Places API）。個人利用でもAPIキーと請求アカウント登録が必須。
- 位置情報: ブラウザのGeolocation API。

## 11. 運用・管理
- AIモデル・ETLジョブの定期モニタリング、異常検知とアラートの整備。
- AI要約の品質サンプリングと手動レビュー体制（運用チーム）。
- ユーザー問い合わせチャネル（FAQ、フォーム、メール）整備。
- データ取得に関するAPIクォータ管理とレートリミット対策。

## 12. リスクと対策
- **SNS API利用制限**: 利用上限を踏まえたキャッシュ・優先度制御を実装し、複数ソースを組み合わせて冗長化。
- **AI要約の誤解釈**: モデルの定期チューニングと人手によるレビュー、ユーザーからの誤り報告機能を設計。
- **著作権・プライバシー**: 公開情報のみを対象にし、画像やテキスト利用時は引用元リンクを明示。削除要請に迅速対応。
- **偏りのあるデータ**: 多様なデータソースを取り込み、人気店舗ばかりに偏らないようランキングアルゴリズムを調整。

## 13. 成功指標 (KPI)
- 月間アクティブユーザー数、再訪率。
- 検索→詳細ページ→お気に入り追加までの遷移率。
- AIおすすめのクリック率、滞在時間。
- データ更新成功率、AI要約品質に関するユーザー満足度（アンケート/フィードバック）。

## 14. 今後の検討事項
- SNSシェア機能、友人とのお気に入りリスト共有機能。
- オフライン対応（PWA）や軽量モードの提供。
- 音声アシスタント連携やチャット形式での店舗相談機能。
- 店舗混雑予測やオープン直後のリアルタイム通知。
